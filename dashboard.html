<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="dashboard">控制台 - 天下太平</title>
    <link rel="stylesheet" href="styles.css">
    <meta name="theme-color" content="#4a69bd">
    <!-- Preload critical assets -->
    <link rel="preload" href="js/ui-enhancement.js" as="script">
</head>
<body class="loading">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div id="language-selector" class="glass"></div>
    
    <div class="header glass">
        <a href="/" class="site-title" data-i18n="title">天下太平</a>
        <div class="nav-links">
            <a href="/dashboard.html" data-i18n="dashboard" class="active">控制台</a>
            <a href="/friends.html" data-i18n="friends">好友</a>
            <a href="/pairing.html" data-i18n="matchmaking">匹配</a>
        </div>
        <div class="auth-links">
            <a href="#" id="logout-btn" data-i18n="logout">登出</a>
        </div>
    </div>
    
    <div class="container content-medium" id="main-content">
        <div class="dashboard-container card">
            <div class="dashboard-header">
                <h2 data-i18n="dashboard">控制台</h2>
                <div class="player-info">
                    <span data-i18n="welcome">欢迎</span>, <span id="username"></span>!
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-card glass">
                    <div class="stat-title" data-i18n="elo_rating">Elo 评分</div>
                    <div class="stat-value" id="elo">-</div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-title" data-i18n="wins">赢</div>
                    <div class="stat-value" id="wins">-</div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-title" data-i18n="losses">输</div>
                    <div class="stat-value" id="losses">-</div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-title" data-i18n="draws">平</div>
                    <div class="stat-value" id="draws">-</div>
                </div>
            </div>
            
            <div class="account-connections glass">
                <h3 data-i18n="connected_accounts">关联账号</h3>
                <div class="connection-list">
                    <div class="connection-item" id="google-connection">
                        <div class="connection-logo">
                            <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/google/google-original.svg" alt="Google">
                        </div>
                        <div class="connection-details">
                            <div class="connection-name">Google</div>
                            <div class="connection-status" id="google-status">
                                <span class="not-connected" data-i18n="not_connected">未关联</span>
                            </div>
                        </div>
                        <div class="connection-action">
                            <button id="google-connect-btn" data-i18n="connect">关联</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="matchmaking-section card">
                <h3 data-i18n="quick_match">快速匹配</h3>
                <div class="quick-actions">
                    <button id="create-room-btn" class="room-button create" data-i18n="create_room">创建房间</button>
                    <button id="join-room-btn" class="room-button join" data-i18n="join_room">加入房间</button>
                    <button id="quick-match-btn" class="room-button quick-match" data-i18n="quick_match">快速匹配</button>
                </div>
            </div>
            
            <div class="match-history">
                <h3 data-i18n="recent_matches">最近比赛</h3>
                <div class="match-list" id="match-list">
                    <div class="match-list-empty" data-i18n="no_recent_matches">无最近比赛</div>
                </div>
            </div>
        </div>
        
        <!-- Add offline support notification -->
        <div id="offline-notification" class="hidden">
            You are currently offline. Some features may be limited.
        </div>
    </div>
    
    <!-- Join Room Modal -->
    <div id="join-room-modal" class="modal" aria-labelledby="join-room-title" aria-hidden="true">
        <div class="modal-content glass">
            <div class="modal-header">
                <h3 id="join-room-title" data-i18n="join_room">加入房间</h3>
                <span class="close-modal" aria-label="Close">&times;</span>
            </div>
            <form id="join-room-form">
                <div class="form-group">
                    <label for="room-id" data-i18n="room_id">房间号</label>
                    <input type="text" id="room-id" data-i18n-placeholder="enter_room_id" required>
                </div>
                <div class="text-center">
                    <button type="submit" data-i18n="join">加入</button>
                </div>
            </form>
        </div>
    </div>
    
    <script src="js/common.js"></script>
    <script type="module" src="js/pages/dashboard.js"></script>
    <script src="js/ui-enhancement.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Offline detection
            window.addEventListener('online', function() {
                document.getElementById('offline-notification').classList.add('hidden');
            });
            
            window.addEventListener('offline', function() {
                document.getElementById('offline-notification').classList.remove('hidden');
            });
            
            // Check initial state
            if (!navigator.onLine) {
                document.getElementById('offline-notification').classList.remove('hidden');
            }
            
            // Modal functionality
            const modal = document.getElementById('join-room-modal');
            const openModalBtn = document.getElementById('join-room-btn');
            const closeModalBtn = document.querySelector('.close-modal');
            
            openModalBtn.addEventListener('click', function() {
                modal.style.display = 'block';
                modal.setAttribute('aria-hidden', 'false');
                document.getElementById('room-id').focus();
            });
            
            closeModalBtn.addEventListener('click', function() {
                modal.style.display = 'none';
                modal.setAttribute('aria-hidden', 'true');
            });
            
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    modal.setAttribute('aria-hidden', 'true');
                }
            });
        });
    </script>
</body>
</html> 