<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="dashboard">控制台 - 天下太平</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" crossorigin="anonymous">
    <!-- NES.css -->
    <link href="https://unpkg.com/nes.css@latest/css/nes.min.css" rel="stylesheet" />
    <!-- Foundation Grid -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/css/foundation-float.min.css" crossorigin="anonymous">
    <!-- Main CSS -->
    <link rel="stylesheet" href="styles.css">
    <meta name="theme-color" content="#0f172a">
    <!-- Preload critical assets -->
    <link rel="preload" href="js/ui-enhancement.js" as="script">
    <!-- Favicon -->
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <style>
        /* Dashboard page style fix for dark blue background */
        body, .dashboard-container {
            background: #1e293b !important;
            color: #f1f5fa;
        }
        .nes-only { display: none !important; }
        .dashboard-container {
            border-radius: 1rem;
            box-shadow: 0 4px 24px rgba(0,0,0,0.18);
            padding: 2rem 1.5rem;
            margin: 2rem 0;
            max-width: 700px;
            width: 100%;
            background: rgba(30,41,59,0.98) !important;
        }
        .stat-card {
            background: #22304a !important;
            border-radius: 0.5rem;
            box-shadow: 0 1px 4px rgba(0,0,0,0.12);
            padding: 1.2rem 0.8rem;
            text-align: center;
            margin-bottom: 0.5rem;
            color: #f1f5fa;
        }
        .stat-title {
            font-size: 0.95rem;
            color: #60a5fa;
            margin-bottom: 0.3rem;
            font-weight: 600;
        }
        .stat-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #fbbf24;
        }
        .account-connections, .matchmaking-section, .match-history {
            background: #22304a !important;
            border-radius: 0.75rem;
            padding: 1.5rem 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.10);
            color: #f1f5fa;
        }
        .connection-logo img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #334155;
            box-shadow: 0 1px 4px rgba(0,0,0,0.12);
        }
        .connection-name {
            font-size: 1rem;
            font-weight: 600;
            color: #60a5fa;
        }
        .connection-status {
            font-size: 0.95rem;
            color: #cbd5e1;
        }
        .connection-action button, .quick-actions button {
            background: #334155 !important;
            color: #f1f5fa !important;
            border: none;
            border-radius: 0.375rem;
            padding: 0.6rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.10);
        }
        .connection-action button:hover, .quick-actions button:hover {
            background: #60a5fa !important;
            color: #1e293b !important;
        }
        .match-list-empty {
            color: #94a3b8;
            font-size: 1.1rem;
            text-align: center;
            padding: 1.5rem 0;
        }
        .player-info {
            font-size: 1.1rem;
            color: #60a5fa;
            margin-bottom: 1.2rem;
        }
        .user-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #334155;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-right: 1rem;
            box-shadow: 0 1px 4px rgba(0,0,0,0.12);
            color: #fbbf24;
        }
        @media (max-width: 600px) {
            .dashboard-container, .account-connections, .matchmaking-section, .match-history {
                padding: 1rem 0.5rem;
                margin: 1rem 0;
            }
            .user-avatar {
                width: 36px;
                height: 36px;
                font-size: 1.3rem;
            }
            .stat-card {
                padding: 0.7rem 0.4rem;
            }
            .stat-title {
                font-size: 0.9rem;
            }
            .stat-value {
                font-size: 1.1rem;
            }
            .quick-actions button {
                font-size: 0.95rem;
                padding: 0.5rem 0.7rem;
            }
        }
    </style>
</head>
<body class="loading dashboard-page">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Theme Switcher -->
    <!-- <div class="theme-switcher">
        <div class="theme-toggle standard-theme active" id="standard-theme">Modern</div>
        <div class="theme-toggle nes-theme" id="nes-theme">Retro</div>
    </div> -->

    <!-- Language Selector -->
    
    <header class="header">
        <div class="container">
            <div class="flex justify-between items-center">
                <div class="site-title-wrapper">
                    <a href="/" class="site-title" data-i18n="title">天下太平</a>
                </div>
                <button class="nav-toggle show-for-small-only" id="nav-toggle">☰</button>
                <div class="nav-links hide-for-small-only">
                    <a href="/" class="home-btn standard-only">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <a href="/" class="home-btn nes-btn nes-only">
                        <i class="nes-icon is-small star"></i> Home
                    </a>
                    <a href="/dashboard.html" data-i18n="dashboard" class="active standard-only">控制台</a>
                    <a href="/friends.html" data-i18n="friends" class="standard-only">好友</a>
                    <a href="/pairing.html" data-i18n="matchmaking" class="standard-only">匹配</a>
                    
                    <a href="/dashboard.html" data-i18n="dashboard" class="nes-btn is-primary nes-only">控制台</a>
                    <a href="/friends.html" data-i18n="friends" class="nes-btn nes-only">好友</a>
                    <a href="/pairing.html" data-i18n="matchmaking" class="nes-btn nes-only">匹配</a>
                </div>
                <div class="auth-links hide-for-small-only">
                    <div class="user-welcome" id="user-welcome">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <a href="#" id="logout-btn" class="btn standard-only" data-i18n="logout">登出</a>
                        <a href="#" id="logout-btn-nes" class="nes-btn is-error nes-only" data-i18n="logout">登出</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Mobile Navigation -->
        <div class="mobile-nav" id="mobile-nav">
            <div class="nav-links">
                <a href="/" class="home-btn standard-only">
                    <i class="fas fa-home"></i> Home
                </a>
                <a href="/" class="home-btn nes-btn nes-only">
                    <i class="nes-icon is-small star"></i> Home
                </a>
                <a href="/dashboard.html" data-i18n="dashboard" class="active standard-only">控制台</a>
                <a href="/friends.html" data-i18n="friends" class="standard-only">好友</a>
                <a href="/pairing.html" data-i18n="matchmaking" class="standard-only">匹配</a>
                
                <a href="/dashboard.html" data-i18n="dashboard" class="nes-btn is-primary nes-only">控制台</a>
                <a href="/friends.html" data-i18n="friends" class="nes-btn nes-only">好友</a>
                <a href="/pairing.html" data-i18n="matchmaking" class="nes-btn nes-only">匹配</a>
            </div>
            <div class="auth-links">
                <div class="user-welcome" id="mobile-user-welcome">
                    <div class="user-avatar" id="mobile-user-avatar">U</div>
                    <a href="#" id="mobile-logout-btn" class="btn standard-only" data-i18n="logout">登出</a>
                    <a href="#" id="mobile-logout-btn-nes" class="nes-btn is-error nes-only" data-i18n="logout">登出</a>
                </div>
            </div>
        </div>
    </header>
    
    <div class="grid-container" id="main-content">
        <div class="grid-x grid-margin-x align-center">
            <div class="cell small-12 medium-10 large-8">
                <!-- NES Theme Content -->
                <div class="dashboard-container nes-container is-rounded with-title nes-only">
                    <p class="title" data-i18n="dashboard">控制台</p>
                    
                    <div class="grid-x grid-margin-x align-middle">
                        <div class="cell auto">
                            <div class="player-info nes-text">
                                <span data-i18n="welcome">欢迎</span>, <span id="username" class="nes-text is-primary" data-sync="username-standard"></span>!
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-container grid-x grid-margin-x small-up-2 medium-up-4">
                        <div class="cell">
                            <div class="stat-card nes-container is-rounded">
                                <div class="stat-title" data-i18n="elo_rating">Elo 评分</div>
                                <div class="stat-value nes-text is-primary" id="elo" data-sync="elo-standard">-</div>
                            </div>
                        </div>
                        <div class="cell">
                            <div class="stat-card nes-container is-rounded">
                                <div class="stat-title" data-i18n="wins">赢</div>
                                <div class="stat-value nes-text is-success" id="wins" data-sync="wins-standard">-</div>
                            </div>
                        </div>
                        <div class="cell">
                            <div class="stat-card nes-container is-rounded">
                                <div class="stat-title" data-i18n="losses">输</div>
                                <div class="stat-value nes-text is-error" id="losses" data-sync="losses-standard">-</div>
                            </div>
                        </div>
                        <div class="cell">
                            <div class="stat-card nes-container is-rounded">
                                <div class="stat-title" data-i18n="draws">平</div>
                                <div class="stat-value nes-text is-warning" id="draws" data-sync="draws-standard">-</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="account-connections nes-container is-rounded margin-vertical-1">
                        <h3 class="nes-text" data-i18n="connected_accounts">关联账号</h3>
                        <div class="connection-list">
                            <div class="connection-item grid-x align-middle">
                                <div class="cell small-3 medium-2">
                                    <div class="connection-logo">
                                        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/google/google-original.svg" alt="Google">
                                    </div>
                                </div>
                                <div class="cell small-6 medium-8">
                                    <div class="connection-details">
                                        <div class="connection-name nes-text">Google</div>
                                        <div class="connection-status" id="google-status">
                                            <span class="not-connected nes-text is-disabled" data-i18n="not_connected">未关联</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="cell small-3 medium-2 text-right">
                                    <div class="connection-action">
                                        <button id="google-connect-btn" class="nes-btn is-primary" data-i18n="connect">关联</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="matchmaking-section nes-container is-rounded margin-vertical-1">
                        <h3 class="nes-text" data-i18n="quick_match">快速匹配</h3>
                        <div class="quick-actions grid-x grid-margin-x text-center">
                            <div class="cell small-12 medium-4">
                                <button id="create-room-btn" class="nes-btn is-success" data-i18n="create_room">创建房间</button>
                            </div>
                            <div class="cell small-12 medium-4">
                                <button id="join-room-btn" class="nes-btn is-warning" data-i18n="join_room">加入房间</button>
                            </div>
                            <div class="cell small-12 medium-4">
                                <button id="quick-match-btn" class="nes-btn is-primary" data-i18n="quick_match">快速匹配</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="match-history nes-container is-rounded margin-vertical-1">
                        <h3 class="nes-text" data-i18n="recent_matches">最近比赛</h3>
                        <div class="match-list" id="match-list">
                            <div class="match-list-empty nes-text is-disabled" data-i18n="no_recent_matches">无最近比赛</div>
                        </div>
                    </div>
                </div>
                
                <!-- Standard Theme Content -->
                <div class="dashboard-container container-card standard-only">
                    <h2 data-i18n="dashboard">控制台</h2>
                    
                    <div class="grid-x grid-margin-x align-middle">
                        <div class="cell auto">
                            <div class="player-info">
                                <span data-i18n="welcome">欢迎</span>, <span id="username-standard"></span>!
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-container grid-x grid-margin-x small-up-2 medium-up-4">
                        <div class="cell">
                            <div class="stat-card container-card">
                                <div class="stat-title" data-i18n="elo_rating">Elo 评分</div>
                                <div class="stat-value" id="elo-standard">-</div>
                            </div>
                        </div>
                        <div class="cell">
                            <div class="stat-card container-card">
                                <div class="stat-title" data-i18n="wins">赢</div>
                                <div class="stat-value" id="wins-standard">-</div>
                            </div>
                        </div>
                        <div class="cell">
                            <div class="stat-card container-card">
                                <div class="stat-title" data-i18n="losses">输</div>
                                <div class="stat-value" id="losses-standard">-</div>
                            </div>
                        </div>
                        <div class="cell">
                            <div class="stat-card container-card">
                                <div class="stat-title" data-i18n="draws">平</div>
                                <div class="stat-value" id="draws-standard">-</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="account-connections container-card margin-vertical-1">
                        <h3 data-i18n="connected_accounts">关联账号</h3>
                        <div class="connection-list">
                            <div class="connection-item grid-x align-middle">
                                <div class="cell small-3 medium-2">
                                    <div class="connection-logo">
                                        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/google/google-original.svg" alt="Google">
                                    </div>
                                </div>
                                <div class="cell small-6 medium-8">
                                    <div class="connection-details">
                                        <div class="connection-name">Google</div>
                                        <div class="connection-status" id="google-status-standard">
                                            <span class="not-connected" data-i18n="not_connected">未关联</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="cell small-3 medium-2 text-right">
                                    <div class="connection-action">
                                        <button id="google-connect-btn-standard" class="btn" data-i18n="connect">关联</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="matchmaking-section container-card margin-vertical-1">
                        <h3 data-i18n="quick_match">快速匹配</h3>
                        <div class="quick-actions grid-x grid-margin-x text-center">
                            <div class="cell small-12 medium-4">
                                <button id="create-room-btn-standard" class="btn" data-i18n="create_room">创建房间</button>
                            </div>
                            <div class="cell small-12 medium-4">
                                <button id="join-room-btn-standard" class="btn" data-i18n="join_room">加入房间</button>
                            </div>
                            <div class="cell small-12 medium-4">
                                <button id="quick-match-btn-standard" class="btn" data-i18n="quick_match">快速匹配</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="match-history container-card margin-vertical-1">
                        <h3 data-i18n="recent_matches">最近比赛</h3>
                        <div class="match-list" id="match-list-standard">
                            <div class="match-list-empty" data-i18n="no_recent_matches">无最近比赛</div>
                        </div>
                    </div>
                </div>
                
                <!-- Offline notifications -->
                <div id="offline-notification" class="nes-container is-rounded is-error hidden nes-only offline-notification">
                    <i class="nes-icon is-small warning"></i> You are currently offline. Some features may be limited.
                </div>
                
                <div id="offline-notification-standard" class="container-card hidden standard-only offline-notification">
                    You are currently offline. Some features may be limited.
                </div>
            </div>
        </div>
    </div>
    
    <!-- Join Room Modal -->
    <div id="join-room-modal" class="reveal" data-reveal aria-labelledby="join-room-title" aria-hidden="true">
        <!-- NES Theme Modal -->
        <div class="nes-container is-rounded with-title nes-only">
            <p class="title" id="join-room-title" data-i18n="join_room">加入房间</p>
            <button class="close-button" data-close aria-label="Close" type="button">
                <span aria-hidden="true">&times;</span>
            </button>
            <form id="join-room-form">
                <div class="nes-field">
                    <label for="room-id" data-i18n="room_id">房间号</label>
                    <input type="text" id="room-id" class="nes-input" data-i18n-placeholder="enter_room_id" required>
                </div>
                <div class="text-center margin-top-1">
                    <button type="submit" class="nes-btn is-primary" data-i18n="join">加入</button>
                </div>
            </form>
        </div>
        
        <!-- Standard Theme Modal -->
        <div class="container-card standard-only">
            <h3 id="join-room-title-standard" data-i18n="join_room">加入房间</h3>
            <button class="close-button" data-close aria-label="Close" type="button">
                <span aria-hidden="true">&times;</span>
            </button>
            <form id="join-room-form-standard">
                <div class="form-group">
                    <label for="room-id-standard" data-i18n="room_id">房间号</label>
                    <input type="text" id="room-id-standard" data-i18n-placeholder="enter_room_id" required>
                </div>
                <div class="text-center margin-top-1">
                    <button type="submit" class="btn" data-i18n="join">加入</button>
                </div>
            </form>
        </div>

    </div>
    <div id="language-selector" class="language-selector"></div>

    <!-- Foundation JS -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/js/foundation.min.js"></script>
    <script>$(document).foundation();</script>
    <script type="module" src="js/common.js"></script>
    <script type="module" src="js/pages/dashboard.js"></script>
    <script src="js/ui-enhancement.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Foundation
            $(document).foundation();
            
            // Sync standard and NES theme buttons
            document.getElementById('join-room-btn-standard').addEventListener('click', function() {
                $('#join-room-modal').foundation('open');
            });
            
            document.getElementById('join-room-btn').addEventListener('click', function() {
                $('#join-room-modal').foundation('open');
            });
            
            // Sync form submissions
            document.getElementById('join-room-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const roomId = document.getElementById('room-id').value;
                joinRoom(roomId);
            });
            
            document.getElementById('join-room-form-standard').addEventListener('submit', function(e) {
                e.preventDefault();
                const roomId = document.getElementById('room-id-standard').value;
                joinRoom(roomId);
            });
            
            // Sync button actions
            document.getElementById('logout-btn').addEventListener('click', logout);
            document.getElementById('mobile-logout-btn').addEventListener('click', logout);
            document.getElementById('mobile-logout-btn-standard').addEventListener('click', logout);
            
            document.getElementById('create-room-btn').addEventListener('click', createRoom);
            document.getElementById('create-room-btn-standard').addEventListener('click', createRoom);
            
            document.getElementById('quick-match-btn').addEventListener('click', quickMatch);
            document.getElementById('quick-match-btn-standard').addEventListener('click', quickMatch);
            
            // Action functions
            function joinRoom(roomId) {
                window.location.href = `/game-room.html?id=${roomId}`;
            }
            
            function logout() {
                // Implement logout functionality
                // This would typically call an API endpoint
                console.log('Logging out...');
                // For now, just redirect to login page
                    window.location.href = '/login.html';
            }
            
            function createRoom() {
                window.location.href = '/create-room.html';
            }
            
            function quickMatch() {
                window.location.href = '/pairing.html';
            }
        });
    </script>
</body>
</html>